package fr.motysten.usertwist.exploit.tools;

public class Cesar {

    public static final String LOWER_ALPHABET = "abcdefghijklmnopqrstuvwxyz";
    public static final String UPPER_ALPHABET = LOWER_ALPHABET.toUpperCase();

    public static String cesarRotate(String input, int offset) {

        while (offset < 0) {
            offset += 26;
        }

        StringBuilder output = new StringBuilder();
        
        for (int i = 0; i < input.length(); i++) {
            char newChar = input.charAt(i);
            if (!Character.isDigit(input.charAt(i))) {
                int pos = LOWER_ALPHABET.indexOf(Character.toLowerCase(input.charAt(i)));
                int newPos = (pos + offset) % 26;
                if (Character.isUpperCase(input.charAt(i))) {
                    newChar = UPPER_ALPHABET.charAt(newPos);
                } else {
                    newChar = LOWER_ALPHABET.charAt(newPos);
                }
            }
            output.append(newChar);
        }

        return output.toString();
    }

}
