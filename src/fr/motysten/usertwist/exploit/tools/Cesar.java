package fr.motysten.usertwist.exploit.tools;

public class Cesar {

    public static String cesarRotate(String input, int offset) {

        String LOWER_ALPHABET = "abcdefghijklmnopqrstuvwxyz";
        if (offset < 0) {
            LOWER_ALPHABET = new StringBuilder(LOWER_ALPHABET).reverse().toString();
            offset = -offset;
        }
        String UPPER_ALPHABET = LOWER_ALPHABET.toUpperCase();

        StringBuilder output = new StringBuilder();


        for (int i = 0; i < input.length(); i++) {
            char newChar = input.charAt(i);
            if (!Character.isDigit(input.charAt(i))) {
                int pos = LOWER_ALPHABET.indexOf(Character.toLowerCase(input.charAt(i)));
                int newPos = (pos + offset) % 26;
                if (Character.isUpperCase(input.charAt(i))) {
                    newChar = UPPER_ALPHABET.charAt(newPos);
                } else {
                    newChar = LOWER_ALPHABET.charAt(newPos);
                }
            }
            output.append(newChar);
        }

        return output.toString();
    }

}
