package fr.motysten.usertwist.exploit.tools;

import org.json.JSONArray;
import org.json.JSONObject;

public class Parser {

    public static void getPass(JSONArray usersArray, int rotation) {
        for (int i = 0; i < usersArray.length(); i++) {
            JSONObject user = usersArray.getJSONObject(i);
            String login = user.getString("username");
            String password = Cesar.rotate(user.getString("data"), rotation);

            System.out.println((i + 1) + ". " + login + " => " + password);
        }
    }

    public static void asyncGetPass(JSONArray usersArray, int rotation) throws InterruptedException {

        for (int i = 0; i < usersArray.length(); i++) {

            int finalI = i;

            Runnable r = () -> {
                JSONObject user = usersArray.getJSONObject(finalI);
                String login = user.getString("username");
                String password = Cesar.rotate(user.getString("data"), rotation);

                System.out.println((finalI + 1) + ". " + login + " => " + password);
            };

            Thread t = Thread.startVirtualThread(r);
            t.join();
        }
    }

}
